# Quality Gates Specification - ONEX Agent Framework
# Phase 1 Deliverable: 23 quality gates across 8 validation types
# Target: <200ms execution per gate, automated validation

schema_version: "1.0.0"
total_gates: 23
total_categories: 8
performance_target_ms: 200

# Quality Gate Categories
categories:
  sequential_validation:
    description: "Input, process, output validation for sequential execution"
    gates: 4
    performance_target_ms: 50

  parallel_validation:
    description: "Distributed validation for parallel agent coordination"
    gates: 3
    performance_target_ms: 100

  intelligence_validation:
    description: "RAG intelligence gathering and application validation"
    gates: 3
    performance_target_ms: 150

  coordination_validation:
    description: "Multi-agent coordination and context inheritance validation"
    gates: 3
    performance_target_ms: 75

  quality_compliance:
    description: "ONEX standards and architectural compliance validation"
    gates: 4
    performance_target_ms: 100

  performance_validation:
    description: "Performance threshold and optimization validation"
    gates: 2
    performance_target_ms: 50

  knowledge_validation:
    description: "Knowledge capture and learning validation"
    gates: 2
    performance_target_ms: 75

  framework_validation:
    description: "Framework integration and lifecycle validation"
    gates: 2
    performance_target_ms: 50

# Quality Gates Specification
quality_gates:
  # Sequential Validation Gates (SV-001 to SV-004)
  SV-001:
    name: "Input Validation"
    description: "Verify all inputs meet requirements before task execution"
    category: "sequential_validation"
    execution_point: "pre_task_execution"
    performance_target_ms: 50
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

  SV-002:
    name: "Process Validation"
    description: "Ensure workflows follow established patterns during execution"
    category: "sequential_validation"
    execution_point: "during_execution"
    performance_target_ms: 30
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "monitoring"
    dependencies: ["SV-001"]

  SV-003:
    name: "Output Validation"
    description: "Comprehensive result verification before completion"
    category: "sequential_validation"
    execution_point: "post_execution"
    performance_target_ms: 40
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: ["SV-002"]

  SV-004:
    name: "Integration Testing"
    description: "Validate agent interactions and handoffs"
    category: "sequential_validation"
    execution_point: "delegation_points"
    performance_target_ms: 60
    mandatory: true
    automation_level: "semi_automated"
    validation_type: "checkpoint"
    dependencies: ["SV-001", "SV-002"]

  # Parallel Validation Gates (PV-001 to PV-003)
  PV-001:
    name: "Context Synchronization"
    description: "Validate consistency across parallel agent contexts"
    category: "parallel_validation"
    execution_point: "parallel_initialization"
    performance_target_ms: 80
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

  PV-002:
    name: "Coordination Validation"
    description: "Monitor parallel workflow compliance in real-time"
    category: "parallel_validation"
    execution_point: "coordination_checkpoints"
    performance_target_ms: 50
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "monitoring"
    dependencies: ["PV-001"]

  PV-003:
    name: "Result Consistency"
    description: "Ensure parallel results are coherent and compatible"
    category: "parallel_validation"
    execution_point: "result_aggregation"
    performance_target_ms: 70
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: ["PV-001", "PV-002"]

  # Intelligence Validation Gates (IV-001 to IV-003)
  IV-001:
    name: "RAG Query Validation"
    description: "Validate intelligence gathering completeness and relevance"
    category: "intelligence_validation"
    execution_point: "intelligence_gathering"
    performance_target_ms: 100
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "quality_check"
    dependencies: []

  IV-002:
    name: "Knowledge Application"
    description: "Verify gathered intelligence is properly applied"
    category: "intelligence_validation"
    execution_point: "execution_planning"
    performance_target_ms: 75
    mandatory: true
    automation_level: "semi_automated"
    validation_type: "monitoring"
    dependencies: ["IV-001"]

  IV-003:
    name: "Learning Capture"
    description: "Validate knowledge capture for future intelligence"
    category: "intelligence_validation"
    execution_point: "completion"
    performance_target_ms: 50
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: ["IV-002"]

  # Coordination Validation Gates (CV-001 to CV-003)
  CV-001:
    name: "Context Inheritance"
    description: "Validate context preservation during delegation"
    category: "coordination_validation"
    execution_point: "agent_delegation"
    performance_target_ms: 40
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

  CV-002:
    name: "Agent Coordination"
    description: "Monitor multi-agent collaboration effectiveness"
    category: "coordination_validation"
    execution_point: "multi_agent_workflows"
    performance_target_ms: 60
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "monitoring"
    dependencies: ["CV-001"]

  CV-003:
    name: "Delegation Validation"
    description: "Verify successful task handoff and completion"
    category: "coordination_validation"
    execution_point: "delegation_completion"
    performance_target_ms: 45
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: ["CV-001", "CV-002"]

  # Quality Compliance Gates (QC-001 to QC-004)
  QC-001:
    name: "ONEX Standards"
    description: "Verify ONEX architectural compliance"
    category: "quality_compliance"
    execution_point: "code_generation"
    performance_target_ms: 80
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

  QC-002:
    name: "Anti-YOLO Compliance"
    description: "Ensure systematic approach methodology"
    category: "quality_compliance"
    execution_point: "workflow_execution"
    performance_target_ms: 30
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "monitoring"
    dependencies: []

  QC-003:
    name: "Type Safety"
    description: "Validate strong typing and type compliance"
    category: "quality_compliance"
    execution_point: "code_generation"
    performance_target_ms: 60
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: ["QC-001"]

  QC-004:
    name: "Error Handling"
    description: "Verify proper OnexError usage and exception chaining"
    category: "quality_compliance"
    execution_point: "error_scenarios"
    performance_target_ms: 40
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: ["QC-001"]

  # Performance Validation Gates (PF-001 to PF-002)
  PF-001:
    name: "Performance Thresholds"
    description: "Validate performance meets established thresholds"
    category: "performance_validation"
    execution_point: "execution_completion"
    performance_target_ms: 30
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: []

  PF-002:
    name: "Resource Utilization"
    description: "Monitor and validate resource usage efficiency"
    category: "performance_validation"
    execution_point: "continuous_monitoring"
    performance_target_ms: 25
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "monitoring"
    dependencies: []

  # Knowledge Validation Gates (KV-001 to KV-002)
  KV-001:
    name: "UAKS Integration"
    description: "Validate unified agent knowledge system contribution"
    category: "knowledge_validation"
    execution_point: "completion"
    performance_target_ms: 50
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: []

  KV-002:
    name: "Pattern Recognition"
    description: "Validate pattern extraction and learning contribution"
    category: "knowledge_validation"
    execution_point: "completion"
    performance_target_ms: 40
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "checkpoint"
    dependencies: ["KV-001"]

  # Framework Validation Gates (FV-001 to FV-002)
  FV-001:
    name: "Lifecycle Compliance"
    description: "Validate agent lifecycle management compliance"
    category: "framework_validation"
    execution_point: "initialization_and_cleanup"
    performance_target_ms: 35
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

  FV-002:
    name: "Framework Integration"
    description: "Verify proper framework integration and @include usage"
    category: "framework_validation"
    execution_point: "initialization"
    performance_target_ms: 25
    mandatory: true
    automation_level: "fully_automated"
    validation_type: "blocking"
    dependencies: []

# Execution Configuration
execution_config:
  parallel_execution: true
  max_concurrent_gates: 5
  timeout_strategy: "fail_fast"
  retry_policy:
    max_retries: 2
    backoff_multiplier: 1.5
  reporting:
    detailed_logs: true
    performance_metrics: true
    compliance_summary: true

# Compliance Requirements
compliance:
  minimum_pass_rate: 100.0  # All gates must pass
  performance_compliance_rate: 95.0  # 95% must meet performance targets
  automation_coverage: 90.0  # 90% fully automated

# Integration Points
integration:
  mandatory_functions: "@MANDATORY_FUNCTIONS.md"
  workflow_framework: "@COMMON_WORKFLOW.md"
  performance_thresholds: "@performance-thresholds.yaml"
  agent_patterns: "@COMMON_AGENT_PATTERNS.md"
