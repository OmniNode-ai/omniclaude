# Handler Contract for Learned Pattern Storage (PostgreSQL)
# Follows omnibase_core.models.contracts.ModelHandlerContract schema
# Ticket: OMN-1605 - Event-driven handler registration
handler_id: effect.learned_pattern.storage.postgres
name: Learned Pattern Storage Handler (PostgreSQL)
contract_version:
  major: 1
  minor: 0
  patch: 0

descriptor:
  node_archetype: effect
  purity: side_effecting
  idempotent: true
  timeout_ms: 30000

capability_outputs:
  - learned_pattern.storage.query
  - learned_pattern.storage.upsert

input_model: omniclaude.nodes.node_pattern_persistence_effect.models.ModelLearnedPatternQuery
output_model: omniclaude.nodes.node_pattern_persistence_effect.models.ModelLearnedPatternQueryResult

supports_lifecycle: true
supports_health_check: true

# Extensible metadata - handler_class required for KafkaContractSource discovery
metadata:
  handler_class: omniclaude.handlers.pattern_storage_postgres.handler_pattern_storage_postgres.HandlerPatternStoragePostgres
  protocol: omniclaude.nodes.node_pattern_persistence_effect.protocols.protocol_pattern_persistence.ProtocolPatternPersistence
  handler_key: postgresql
  author: OmniNode Team
  license: MIT
  ticket: OMN-1403
  tags:
    - learned-patterns
    - postgresql
    - effect
    - storage
