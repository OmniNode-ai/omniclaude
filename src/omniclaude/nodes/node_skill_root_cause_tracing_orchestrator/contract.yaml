# SPDX-FileCopyrightText: 2025 OmniNode.ai Inc.
# SPDX-License-Identifier: MIT

# Copyright (c) 2025 OmniNode Team
#
# ONEX Node Contract — generated by generate_skill_node.py
# Node: NodeSkillroot_cause_tracingOrchestrator
# Skill: root-cause-tracing
# Created: 2026-02-24
#
# Orchestrator shell node: dispatches skill invocations to the polymorphic
# agent (Polly) via the shared handle_skill_requested handler.
# All heavy logic lives in the shared handler — this node is a thin shell.

# Contract identifiers
name: node_skill_root_cause_tracing_orchestrator
contract_name: node_skill_root_cause_tracing_orchestrator
node_name: node_skill_root_cause_tracing_orchestrator

contract_version:
  major: 1
  minor: 0
  patch: 0

node_version:
  major: 1
  minor: 0
  patch: 0

# Node type
node_type: ORCHESTRATOR_GENERIC

# Description
description: >
  Orchestrator node for the root-cause-tracing skill.
  Use when errors occur deep in execution and you need to trace back to find the original trigger - systematically traces bugs backward through call stack, adding instrumentation when needed, to identify source of invalid data or incorrect behavior
  Dispatches skill invocations to the polymorphic agent via the shared
  handle_skill_requested handler. Subscribes to command events, emits
  outcome events on success or failure.

# Strongly typed I/O models (shared across all skill nodes)
input_model:
  name: ModelSkillRequest
  module: omniclaude.nodes.shared.models

output_model:
  name: ModelSkillResult
  module: omniclaude.nodes.shared.models

# Execution backend configuration
# Execution backend configuration
execution:
  backend: claude_code       # claude_code | local_llm
  model_purpose: null        # null for claude_code; required for local_llm
                             # valid: CODE_ANALYSIS | REASONING | ROUTING | GENERAL
# Event bus configuration
event_bus:
  subscribe:
    topic: "onex.cmd.omniclaude.root-cause-tracing.v1"
    consumer_group: "omniclaude.skill.root_cause_tracing"
  publish:
    success_topic: "onex.evt.omniclaude.root-cause-tracing-completed.v1"
    failure_topic: "onex.evt.omniclaude.root-cause-tracing-failed.v1"

# Capabilities
capabilities:
  - name: skill.root_cause_tracing
    description: Dispatch root-cause-tracing skill to polymorphic agent
    version: 1.0.0

# IO operations
io_operations:
  - operation: skill_requested
    description: Dispatch root-cause-tracing skill invocation to polymorphic agent
    handler_method: handle_skill_requested
    input_fields:
      - skill_name: str
      - skill_path: str
      - args: dict[str, str]
      - correlation_id: UUID
    output_fields:
      - skill_name: str
      - status: SkillResultStatus
      - output: str | None
      - error: str | None
      - correlation_id: UUID
    idempotent: false

# Dependencies
dependencies:
  - name: handler_skill_requested
    type: handler
    function: handle_skill_requested
    module: omniclaude.nodes.shared
    pluggable: false

# Error handling
error_handling:
  retry_policy:
    max_retries: 2
    initial_delay_ms: 500
    max_delay_ms: 5000
    exponential_base: 2
    retry_on:
      - SkillDispatchError
      - SkillTimeoutError
  circuit_breaker:
    enabled: false

# Metadata
metadata:
  author: OmniNode Team
  license: MIT
  generated_by: generate_skill_node.py
  maturity: stub
  tags:
    - orchestrator
    - skill
    - root_cause_tracing
