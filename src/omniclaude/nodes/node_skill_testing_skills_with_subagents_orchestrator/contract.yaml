# SPDX-FileCopyrightText: 2025 OmniNode.ai Inc.
# SPDX-License-Identifier: MIT

# Copyright (c) 2025 OmniNode Team
#
# ONEX Node Contract — generated by generate_skill_node.py
# Node: NodeSkilltesting_skills_with_subagentsOrchestrator
# Skill: testing-skills-with-subagents
# Created: 2026-02-24
#
# Orchestrator shell node: dispatches skill invocations to the polymorphic
# agent (Polly) via the shared handle_skill_requested handler.
# All heavy logic lives in the shared handler — this node is a thin shell.

# Contract identifiers
name: node_skill_testing_skills_with_subagents_orchestrator
contract_name: node_skill_testing_skills_with_subagents_orchestrator
node_name: node_skill_testing_skills_with_subagents_orchestrator

contract_version:
  major: 1
  minor: 0
  patch: 0

node_version:
  major: 1
  minor: 0
  patch: 0

# Node type
node_type: ORCHESTRATOR_GENERIC

# Description
description: >
  Orchestrator node for the testing-skills-with-subagents skill.
  Use when creating or editing skills, before deployment, to verify they work under pressure and resist rationalization - applies RED-GREEN-REFACTOR cycle to process documentation by running baseline without skill, writing to address failures, iterating to close loopholes
  Dispatches skill invocations to the polymorphic agent via the shared
  handle_skill_requested handler. Subscribes to command events, emits
  outcome events on success or failure.

# Strongly typed I/O models (shared across all skill nodes)
input_model:
  name: ModelSkillRequest
  module: omniclaude.nodes.shared.models

output_model:
  name: ModelSkillResult
  module: omniclaude.nodes.shared.models

# Execution backend configuration
# Execution backend configuration
execution:
  backend: claude_code       # claude_code | local_llm
  model_purpose: null        # null for claude_code; required for local_llm
                             # valid: CODE_ANALYSIS | REASONING | ROUTING | GENERAL
# Event bus configuration
event_bus:
  subscribe:
    topic: "onex.cmd.omniclaude.testing-skills-with-subagents.v1"
    consumer_group: "omniclaude.skill.testing_skills_with_subagents"
  publish:
    success_topic: "onex.evt.omniclaude.testing-skills-with-subagents-completed.v1"
    failure_topic: "onex.evt.omniclaude.testing-skills-with-subagents-failed.v1"

# Capabilities
capabilities:
  - name: skill.testing_skills_with_subagents
    description: Dispatch testing-skills-with-subagents skill to polymorphic agent
    version: 1.0.0

# IO operations
io_operations:
  - operation: skill_requested
    description: Dispatch testing-skills-with-subagents skill invocation to polymorphic agent
    handler_method: handle_skill_requested
    input_fields:
      - skill_name: str
      - skill_path: str
      - args: dict[str, str]
      - correlation_id: UUID
    output_fields:
      - skill_name: str
      - status: SkillResultStatus
      - output: str | None
      - error: str | None
      - correlation_id: UUID
    idempotent: false

# Dependencies
dependencies:
  - name: handler_skill_requested
    type: handler
    function: handle_skill_requested
    module: omniclaude.nodes.shared
    pluggable: false

# Error handling
error_handling:
  retry_policy:
    max_retries: 2
    initial_delay_ms: 500
    max_delay_ms: 5000
    exponential_base: 2
    retry_on:
      - SkillDispatchError
      - SkillTimeoutError
  circuit_breaker:
    enabled: false

# Metadata
metadata:
  author: OmniNode Team
  license: MIT
  generated_by: generate_skill_node.py
  maturity: stub
  tags:
    - orchestrator
    - skill
    - testing_skills_with_subagents
